SELECT A.SUB_ID, CASE WHEN B.CT IS NULL THEN 0 ELSE B.CT END FROM 
(select DISTINCT sub_id from SUB WHERE SUB.PARENT_ID IS NULL)A LEFT JOIN 
(SELECT parent_id, COUNT(DISTINCT sub_id) AS CT FROM SUB GROUP BY parent_id)B
ON A.SUB_ID=B.parent_id 
